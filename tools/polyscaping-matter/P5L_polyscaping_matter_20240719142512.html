<!DOCTYPE html>
<html>
<head>
	<title>polyscaping_matter</title>
	<meta charset="utf-8">
	<!-- Compiled w/ P5LIVE, http://github.com/ffd8/p5live -->
	<style type="text/css">
		body{
			margin:0;
			overflow:hidden;
		}
		canvas{
			position:fixed;
			top:0;
			left:0;
			z-index:-1;
			width:100vw;
			height:100vh;
			margin:0;
		}
	</style>
	<script type="text/javascript">
		// eco-mode = only render if window focused
		window.onblur = function () {
			noLoop();
		};
		window.onfocus = function () {
			loop();
		};
	</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.2/p5.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/hydra-synth"></script>
<script type="text/javascript" src="includes/libs/hydra-synth.js"></script>

</head>
<body style="background: rgb(0, 0, 0);">
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ffd8/hy5@main/hy5.js"></script>
<script type="text/javascript" src="includes/libs/hy5.js"></script>
<script type="text/javascript">
//polyscaping_matter

/* CUSTOM FUNCTIONS FOR P5LIVE */
// keep fullscreen if window resized
function windowResized() {
	resizeCanvas(windowWidth, windowHeight);
}

// custom ease function
function ease(iVal, oVal, eVal){
	return oVal += (iVal - oVal) * eVal;
}

// processing compatibility
function println(msg){
	print(msg);
}


var credits = {
	names: [
		'nicola.boss'
	],
	class: 'IDCE SW24',
	description: `have fun creating your own beauthiful little landscape... enjoy your stay!`
}

let fc = 0
let hselect = "h1"
let sliderCY
let sliderCYB
let sliderX
let sliderY
let sliderZ
let sliderRX
let sliderRY
let sliderRZ
let sliderObj
var myEllys = []
let lci = 10
let lcj = 10
let colorPicker
let libs = ['https://unpkg.com/hydra-synth', 'includes/libs/hydra-synth.js', 'https://cdn.jsdelivr.net/gh/ffd8/hy5@main/hy5.js', 'includes/libs/hy5.js']

// sandbox

gradient()
	.modulate(noize(25).colorama(.5, .3).scale(20, 10, 1))
	.modulate(voronoi(50, 1).rotate(20, .01))
	.modulatePixelate(noize(5, .03).invert(), 10)
	.color(.9, .4, 0)
	.brightness(0.2)
	.invert()
	.out(o0)

voronoi(6, .5, .01)
	.modulate(voronoi(500).rotate(65, .07))
	.color(.3, .9, .3, )
	.brightness(.1)
	.out(o1)

gradient()
	.modulateRepeat(noize(), 20)
	.hue(.6)
	.color(.4, .6, 0)
	.brightness(.1)
	.out(o2)

osc(30, .01)
	.modulatePixelate(noize(5), 20, 5)
	.scale(10)
	.modulateKaleid(solid(1, ), 10)
	.colorama(2)
	.color(.9, .1, .3)
	.hue(.2)
	.brightness(.3)
	.out(o3)

render()

P5.z(0)
H.toggle(1)
P5.toggle(1)

function setup() {
	createCanvas(windowWidth, windowHeight, WEBGL)
	initGUI()
	H.render() //h0, h1, h2, h3


	for(let j = 0; j < lcj; j++) {
		for(let i = 0; i < lci; i++) {
			let mapSW = map(j, 0, lcj - 1, -width / 2, width * .6)
			let mapSH = map(i, 0, lci - 1, -width / 2, width * .6)
			myEllys.push(new Elly(mapSH, mapSW, h1))
		}
	}

}

function draw() {
	angleMode(DEGREES)

	fc += sliderfcn.value()

	if(checkTrail.checked()) {
		orbitControl(3)

	} else {
		background(0)
		H.render() //h0, h1, h2, h3
		push()
		rotateY(sliderCYB.value())
		noStroke()
		texture(h0)
		sphere(width * 2)
		pop()
	}

	orbitControl(0, 0, 3)
	rotateY(sliderCY.value())
	lights()

	let meC = 0
	for(let me of myEllys) {
		me.fill = 255
		me.selected = false

		if(meC == floor(fc) % 100) {
			if(checkSpeed.checked()) {
				me.fill = ("white")
				me.selected = true
			}
		}
		if(meC == constrain(floor(sliderfcn.value() * 100), 0, 99)) { //sliderObj.value()
			if(checkSpeed.checked()) {} else {
				me.fill = ("white")
				me.selected = true
			}
		}
		if(me.selected) {
			me.Sx = sliderX.value()
			me.Sy = sliderY.value()
			me.Sz = sliderZ.value()
			me.Rx = sliderRX.value()
			me.Ry = sliderRY.value()
			me.Rz = sliderRZ.value()
			me.tex = eval(hselect)

		}
		me.display()
		meC++
	}
}



class Elly {

	constructor(x, z, tex) {
		this.x = x
		this.z = z
		this.y = height * .55
		this.Sx = height * .12
		this.Sy = height * .12
		this.Sz = height * .12
		this.Rx = 0
		this.Ry = 0
		this.Rz = 0
		this.Svx = 3
		this.Svy = 3
		this.fill = 255
		this.tex = tex
		this.selected = false
	}

	display() {
		push()
		translate(this.x, this.y, this.z)
		noStroke()
		fill(this.fill)
		rotateX(this.Rx)
		rotateY(this.Ry)
		rotateZ(this.Rz)
		texture(this.tex)

		ellipsoid(this.Sx, this.Sy, this.Sz, this.Svx, this.Svy)
		if(this.selected) {
			noFill()
			stroke(this.fill)
			strokeWeight(3)
			ellipsoid(this.Sx + 5, this.Sy + 5, this.Sz + 5, this.Svx, this.Svy)
		}
		pop()
	}
}

function initGUI() {



	guiBoard = createDiv("").class("guiboard")

	createDiv("Polyscaping Matter").class("guiBar").draggable(guiBoard)

	//createElement("br").parent(guiBoard)
	createDiv("use MouseScroll to zoom").parent(guiBoard).class("guiLabel")
	createDiv("---------------------").parent(guiBoard).class("guiLabel")
	createDiv("camera control").parent(guiBoard).class("guiLabel")
	sliderCY = createSlider(0, 360, 0)
		.parent(guiBoard).class("guiSlider")
	createDiv("Background Control").parent(guiBoard).class("guiLabel")
	sliderCYB = createSlider(0, 360, 0)
		.parent(guiBoard).class("guiSlider")

	createDiv("change size").parent(guiBoard).class("guiLabel")
	sliderX = createSlider(height * 0, height * .5, height * .12) //min, max, default, (sensitivity)
		.parent(guiBoard).class("guiSlider")

	sliderY = createSlider(height * 0, height * .5, height * .12)
		.parent(guiBoard).class("guiSlider")

	sliderZ = createSlider(height * 0, height * .5, height * .12)
		.parent(guiBoard).class("guiSlider")

	createDiv("change rotation").parent(guiBoard).class("guiLabel")
	sliderRX = createSlider(0, 360, 90) //min, max, default, (sensitivity)
		.parent(guiBoard).class("guiSlider")

	sliderRY = createSlider(0, 360, 90)
		.parent(guiBoard).class("guiSlider")

	sliderRZ = createSlider(0, 360, 90)
		.parent(guiBoard).class("guiSlider")

	createDiv("toggle automatic/manual edit").parent(guiBoard).class("guiLabel")
	checkSpeed = createCheckbox("", true).parent(guiBoard).class("guiCheck")
	//sliderfcn = createSlider(1, 100, 50, )
	sliderfcn = createSlider(0, 1, .1, .001)
		.parent(guiBoard).class("guiSlider")
	createElement("br").parent(guiBoard)
	//createElement("br").parent(guiBoard)


	createDiv("start painting -> drag with mouse").parent(guiBoard).class("guiLabel")
	checkTrail = createCheckbox("", false).parent(guiBoard).class("guiCheck")
	//createElement("br").parent(guiBoard)

	createDiv("choose texture").parent(guiBoard).class('guiLabel')
	myDropdown = createSelect('').parent(guiBoard).class("guiDrop").input(function() {
		hselect = this.value()
	})
	myDropdown.option('forest', "h1")
	myDropdown.option('earth', "h2")
	myDropdown.option('meadow', "h3")

	//createDiv("color picker").parent(guiBoard).class("guiLabel")
	//colorPicker = createColorPicker("white").parent(guiBoard).class("guiColor")

	//createElement("br").parent(guiBoard)
	//createElement("br").parent(guiBoard)
	createButton("save image").parent(guiBoard).class("guiButton").mouseClicked(function() {
		save("myPolyscape.png")

	})

	createElement('style', `
	
        	.guiboard{
            position:fixed;
            right:1em;
            top:1em;
            width:15%;
            height:90%;
            background:none;
            border-style:dashed;
            border-color:white;
            font-family:helvetica;
            padding:.5%;
            border-radius: 2%;
            outline:none;
        }
        .guiBar{
        	position: relative;
            background:none;
            color:white;
            text-align:center;
            display: flex;
            justify-content: center;
            height:2%;
            width:20%;
            padding: 4%;
            font-size: 1.6em;
            font-family: helvetica;
        }
        .guiLabel{
        	text-align:center;
            color:#fff;
            padding:1%;
        }
        .guiSlider{
            width:95%;
            padding:.01%;
        }
        .guiCheck{
            text-align:center;
            
        }
        .guiButton{
            clear:both;
            padding:4%;
            border-radius:2%;
            font-size:1.2em;
            background-color:white;
            width:100%;
        }
        .guiDrop{
            clear:both;
            text-align: center;
            padding:1%;
            border-radius:2%;
            font-size:1em;
            background-color:white;
            width:100%;
        }
        .guiColor{
            border-radius:2%;
            background-color:white;
            width:100%;
        }
    `)


}
</script>

</body>
</html>